
@{
    ViewBag.Title = "RADA Logistics - Entry Container";
}

@*<link href="~/Stylee/PageRADAEntry.css" rel="stylesheet" />*@
<link href="~/Stylee/RADAREntryRecordsmail.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<div class="container" style="text-align: center; width: 100%; height: 100%">

    <div style="text-align: center; min-width: 100%; ">

        <style>
            .page-title {
                text-align: center;
                font-size: 21px;
                font-weight: 700;
                color: #2c3e50;
                margin-bottom: 15px;
                letter-spacing: 0px;
            }

            .section-subtitle {
                text-align: center;
                font-size: 17px;
                font-weight: 500;
                color: #555;
                margin-bottom: 25px;
            }
        </style>

        <div class="choffer-float">
            <div class="choffer-box">
                <h4 class="choffer-title">Drivers Without Movement</h4>

                <div class="choffer-scroll">
                    <table class="choffer-table">
                        <thead>
                            <tr>
                                <th>Choffer</th>
                                <th>Message</th>
                                <th>MOV.</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (ViewBag.RadaUsers != null)
                            {
                                foreach (var choffer in ViewBag.RadaUsers)
                                {
                                    <tr>
                                        <td>@choffer.Username</td>
                                        <td>@choffer.message</td>
                                        <td>@choffer.Mov</td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td style="padding: 6px; text-align: center;"> - </td>
                                    <td style="padding: 6px; text-align: center;"> - </td>
                                    <td style="padding: 6px; text-align: center;"> - </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <h2 class="page-title" style="font-weight: 700;">Entry of requested container movements</h2>
        <h4 class="section-subtitle">Container inbound and request</h4>

        <input value="@ViewBag.User" hidden="hidden" id="user" name="user" />
        <hr>
        <div style=" display: flex; justify-content: center; align-items: center; height: auto;">
            <button class="animated-button" onclick="location.href='@Url.Action("RadaHome", "Home")'">
                <svg xmlns="http://www.w3.org/2000/svg" class="arr-2" viewBox="0 0 24 24">
                    <path d="M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"></path>
                </svg>
                <span class="text">Return to back</span>
                <span class="circle"></span>
                <svg xmlns="http://www.w3.org/2000/svg" class="arr-1" viewBox="0 0 24 24">
                    <path d="M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"></path>
                </svg>
            </button>
        </div>
        <hr>
    </div>
</div>

@using (Html.BeginForm("Query", "RADA", FormMethod.Post))
{
    <div class="form-row" style="text-align: center; margin: 15px 0;">
        <input id="fecha" name="fecha" type="date"
               style="padding: 8px 12px;
               font-size: 14px;
               border: 1px solid #ccc;
               border-radius: 8px;
               max-width: 220px;
               width: 100%;
               box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
               transition: border-color 0.3s ease, box-shadow 0.3s ease;" />
    </div>

    <p style="text-align: center;">&nbsp;</p>

    <div style="display: flex; justify-content: center; margin: 10px 0;">
        <button type="submit" class="Bto_saved" style="text-align: center;">
            🔍 Query
        </button>
    </div>
}

<p style="text-align: center;">&nbsp;</p>

<h4 style="text-align: center; font-weight: 700;" class="Tittlelabel"> Latest requested records entered into the system </h4>
<h5 style="text-align:center" class="Tittlelabel"> Total Records: @ViewBag.Count</h5>

<div class="table-scroll">

    <ul class="responsive-table">

        <li class="table-header" id="tableData">

            <div class="col col-15" style="text-align:center">Comment</div>

            <div class="col col-1" style="text-align:center">Folio</div>

            <div class="col col-2" style="text-align:center">Container</div>

            <div class="col col-3" style="text-align:center">Origins</div>

            <div class="col col-4" style="text-align:center">Destination</div>

            <div class="col col-5" style="text-align:center">Status</div>

            <div class="col col-6" style="text-align:center">HRequest</div>

            <div class="col col-7" style="text-align:center">HConfirm</div>

            <div class="col col-8" style="text-align:center">HFinish</div>

            <div class="col col-9" style="text-align:center">Who Request</div>

            <div class="col col-10" style="text-align:center">Choffer</div>

            <div class="col col-11" style="text-align:center">Comment</div>

            <div class="col col-12" style="text-align:center">Area</div>

            <div class="col col-13" style="text-align:center">Date</div>

            <div class="col col-14" style="text-align:center">Options</div>

        </li>

        <div id="tabla-container">
            @Html.Partial("table") <!-- Cargar la tabla al inicio -->
        </div>

    </ul>

</div>

    <p style="text-align: center;">&nbsp;</p>
    <p style="text-align: center;">&nbsp;</p>

    <script>
    var query = '@ViewBag.User';
    function actualizarTabla() {
        $.ajax({
            url: '/RADA/ActualizarTabla', // Llama al método en el controlador
            type: 'GET',
            data: { name: query || "" },
            success: function (data) {
                $("#tabla-container").html(data); // Reemplaza la tabla con la nueva versión
                console.log("Tabla actualizada.");
            },
            error: function () {
                console.log("Error al actualizar la tabla.");
            }
        });
    }

    // Llamar la función cada 1 minuto (60,000 milisegundos)
    setInterval(actualizarTabla, 60000);
    </script>
